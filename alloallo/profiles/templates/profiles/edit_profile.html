{% extends "base.html" %}

{% load staticfiles %}
{% load crispy_forms_tags %}
{% load thumbnail %}

{% block title %}{{ block.super }}Profile{% endblock %}

<!-- Benefits of the Django application -->
{% block container %}

<div class="container">
  <h1 class="text-primary">Edit Profile</h1>
  <hr>
  <div class="row">
    <!-- left column -->
    <div class="col-md-3">
      <div class="text-center">
        <img title="profile picture" class="img-circle img-responsive" src="{% thumbnail user.profile.picture|default:'default_profile.png' 140x140 crop %}">
      </div>
    </div>
      
    <!-- edit form column -->
    <div class="col-md-9">
      <h3>Personal info</h3>
      <form enctype="multipart/form-data" method="post">
	{% crispy user_form %}
	{% crispy profile_form %}
      </form>
      <a class="btn btn-default pull-right" href="{% url 'accounts:password-change' %}">Change Password</a>
      <h3>Subscription</h3>
      {% if not user.is_paid %}
          <form id="checkout" method="post" action="{% url "payments:checkout" %}">
            <div id="payment-form"></div>
            <input type="submit" value="Subscribe">
          </form>
          <script src="https://js.braintreegateway.com/v2/braintree.js"></script>
          <script>
            braintree.setup("{{ user.get_client_token }}", "dropin", {
              container: "payment-form"
            });
          </script>
      {% else %}
        Your subscription is already active!
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}


